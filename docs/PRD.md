# Product Requirements Document (PRD)
## DayForm - 일일 동기부여 질문 앱

### 문서 정보
- **버전**: 1.0
- **작성일**: 2025-10-25
- **프로젝트명**: DayForm (일일 질문 답변 앱)
- **플랫폼**: Android (Flutter)

---

## 1. 제품 개요

### 1.1 목적
사용자가 매일 자신의 일과, 목표 달성도, 건강, 환경 실천 등을 스스로 점검하고 기록할 수 있는 동기부여 중심의 생산성 앱

### 1.2 목표 사용자
- 자기 계발과 일상 기록에 관심 있는 개인 사용자
- 습관 형성과 목표 달성을 추적하고 싶은 사용자
- 간단하고 직관적인 일일 체크인 도구가 필요한 사용자

### 1.3 핵심 가치 제안
- **간단함**: 복잡한 설정 없이 바로 사용 가능
- **유연성**: 텍스트, 진행도, 체크박스 등 다양한 답변 형식 지원
- **지속성**: 백그라운드 알림으로 일일 체크인 습관 형성 지원
- **프라이버시**: 로컬 저장으로 개인 데이터 보호

---

## 2. 기능 요구사항

### 2.1 핵심 기능

#### 2.1.1 질문 답변 기능
**우선순위**: P0 (필수)

**설명**: 사용자가 오늘의 질문에 답변을 입력하고 저장할 수 있는 기능

**기능 상세**:
- 질문 카드 형태의 UI
- 카드 탭하여 확장/축소 (Expand/Collapse)
- 여러 카드를 동시에 확장 가능
- 세 가지 답변 타입 지원:
  - **텍스트 타입**: 자유 형식 텍스트 입력
  - **진행도 타입**: 0-100% 슬라이더 입력
  - **체크 타입**: 완료/미완료 체크박스 입력

**사용자 시나리오**:
1. 사용자가 앱을 열면 오늘의 질문 목록이 표시됨
2. 질문 카드를 탭하면 답변 입력 영역이 확장됨
3. 질문 타입에 맞는 입력 위젯이 표시됨
4. 답변 입력 후 '저장하기' 버튼 클릭
5. 카드가 자동으로 축소되고 시각적 피드백 제공 (배경색 변경, 체크 아이콘)
6. 답변 미리보기가 카드에 표시됨

**기술 요구사항**:
- StatefulWidget으로 상태 관리
- AnimatedSize 위젯으로 확장/축소 애니메이션
- TextEditingController, Slider, Checkbox 위젯 사용
- SharedPreferences를 통한 로컬 저장

#### 2.1.2 질문 관리 기능
**우선순위**: P0 (필수)

**설명**: 초기 질문은 JSON 파일에서 로드되며, 이후 SharedPreferences에 저장되어 동적 관리 가능

**기능 상세**:
- 최초 실행 시 `assets/questions.json`에서 질문 로드
- 이후 SharedPreferences에 저장하여 관리
- 질문 추가, 수정, 삭제, 순서 변경 지원
- 세 가지 질문 타입: text, progress, check

**데이터 구조**:
```json
{
  "questions": [
    {
      "id": "q1",
      "text": "오늘 어떤 일들을 했나요?",
      "type": "text"
    }
  ]
}
```

**기술 요구사항**:
- QuestionService 싱글톤 패턴
- JSON 파일 파싱
- SharedPreferences 마이그레이션 로직
- CRUD 작업 지원

#### 2.1.3 답변 히스토리 기능
**우선순위**: P0 (필수)

**설명**: 사용자가 작성한 과거 답변을 날짜별로 조회할 수 있는 기능

**기능 상세**:
- 답변을 날짜별로 그룹화하여 표시
- 각 질문의 답변 타입에 맞게 렌더링
  - 텍스트: 텍스트 표시
  - 진행도: 진행률 바와 퍼센트 표시
  - 체크: 완료/미완료 아이콘과 상태 표시
- 최신 답변부터 역순으로 정렬
- 하단 탭을 통한 접근

**사용자 시나리오**:
1. 하단 탭에서 '히스토리' 탭 선택
2. 날짜별로 그룹화된 답변 목록 표시
3. 각 답변의 질문 제목과 답변 내용 확인
4. 스크롤하여 과거 기록 탐색

**기술 요구사항**:
- StorageService를 통한 데이터 조회
- GroupBy 로직으로 날짜별 그룹화
- 타입별 커스텀 렌더링

#### 2.1.4 백그라운드 알림 기능
**우선순위**: P1 (중요)

**설명**: 앱이 백그라운드로 전환되면 일정 시간 후 알림을 발송하여 사용자가 답변을 작성하도록 유도

**기능 상세**:
- 앱이 백그라운드로 전환되면 5초 후 알림 스케줄링
- 앱 실행 시 기존 알림 취소하여 중복 방지
- 알림 탭 시 앱 실행
- 고정 메시지: "오늘의 질문이 준비되었어요! 당신의 하루를 되돌아볼 시간입니다."

**기술 요구사항**:
- flutter_local_notifications 라이브러리
- workmanager 라이브러리 (백그라운드 작업)
- WidgetsBindingObserver로 앱 라이프사이클 감지
- Android 알림 채널 설정

#### 2.1.5 답변 초기화 기능
**우선순위**: P2 (보통)

**설명**: 모든 답변을 삭제하고 초기 상태로 되돌리는 기능

**기능 상세**:
- 홈 화면 상단 우측에 새로고침 아이콘 버튼
- 버튼 클릭 시 확인 다이얼로그 표시
- 확인 후 모든 답변 삭제
- UI 강제 새로고침 (ValueKey 증가)

**사용자 시나리오**:
1. 홈 화면에서 새로고침 아이콘 탭
2. "모든 답변을 삭제하시겠습니까?" 다이얼로그 표시
3. '삭제' 버튼 선택
4. 모든 답변이 삭제되고 카드가 초기 상태로 변경
5. "모든 답변이 삭제되었습니다" 스낵바 표시

**기술 요구사항**:
- AlertDialog 확인 UI
- StorageService.clearAllAnswers()
- ValueKey with _refreshKey 증가로 강제 리빌드

#### 2.1.6 이전 답변 로드 기능
**우선순위**: P1 (중요)

**설명**: 답변이 이미 저장된 질문 카드를 다시 열면 이전 답변이 자동으로 입력되어 있음

**기능 상세**:
- 카드 확장 시 해당 질문의 최신 답변 조회
- 답변 타입에 맞게 입력 필드에 값 설정
  - 텍스트: TextEditingController.text 설정
  - 진행도: 슬라이더 값 설정
  - 체크: 체크박스 상태 설정
- 사용자가 값을 수정하여 재저장 가능

**기술 요구사항**:
- _loadLatestAnswer() 메서드
- StorageService.getLatestAnswerForQuestion()
- 타입별 상태 초기화 로직

### 2.2 사용자 인터페이스 요구사항

#### 2.2.1 디자인 원칙
- **심플함**: 최소한의 UI 요소로 깔끔한 디자인
- **직관성**: 사용자가 별도 학습 없이 바로 사용 가능
- **Material Design 3**: 일관된 구글 디자인 언어 적용
- **시각적 피드백**: 답변 완료 시 색상, 아이콘으로 상태 표시

#### 2.2.2 화면 구성

##### 홈 화면
- 앱바: "오늘의 질문" 제목, 우측 새로고침 버튼
- 본문: 질문 카드 리스트
- 카드 구성:
  - 좌측: 타입별 색상 아이콘
  - 중앙: 질문 텍스트, 타입 레이블
  - 우측: 답변 완료 시 체크 아이콘, 확장/축소 아이콘
  - 답변 미리보기 (축소 상태, 답변 있을 때)
  - 답변 입력 영역 (확장 상태)
- 하단: 탭 네비게이션 바

##### 히스토리 화면
- 앱바: "답변 히스토리" 제목
- 본문: 날짜별 그룹화된 답변 목록
- 답변 카드:
  - 질문 제목
  - 답변 내용 (타입별 렌더링)
  - 작성 시간
- 하단: 탭 네비게이션 바

##### 질문 관리 화면
- 앱바: "질문 관리" 제목, 우측 추가 버튼
- 본문: 재정렬 가능한 질문 리스트
- 질문 카드:
  - 드래그 핸들
  - 질문 텍스트
  - 타입 레이블
  - 수정/삭제 버튼
- 하단: 탭 네비게이션 바

#### 2.2.3 색상 체계
- **Primary**: Blue (질문 카드, 버튼)
- **답변 완료 카드**: Light Blue 배경
- **미답변 카드**: White 배경
- **텍스트 타입**: Blue 아이콘
- **진행도 타입**: Green 아이콘
- **체크 타입**: Orange 아이콘
- **경고/삭제**: Red/Orange

---

## 3. 기술 사양

### 3.1 플랫폼 및 기술 스택

| 구분 | 기술 |
|------|------|
| 플랫폼 | Android |
| 프레임워크 | Flutter 3.8.1 |
| 언어 | Dart 3.8.1 |
| 상태 관리 | StatefulWidget + setState |
| 로컬 저장소 | SharedPreferences |
| 알림 | flutter_local_notifications 17.0.0 |
| 백그라운드 작업 | workmanager 0.9.0 |
| 날짜/시간 포맷 | intl 0.19.0 |
| Android NDK | 27.0.12077973 |

### 3.2 아키텍처

#### 3.2.1 프로젝트 구조
```
lib/
├── main.dart                          # 앱 진입점
├── models/
│   ├── question.dart                  # 질문 데이터 모델
│   └── answer.dart                    # 답변 데이터 모델
├── services/
│   ├── question_service.dart          # 질문 관리 서비스 (Singleton)
│   ├── storage_service.dart           # 답변 저장 서비스 (Singleton)
│   └── notification_service.dart      # 알림 서비스 (Singleton)
├── screens/
│   ├── main_screen.dart               # 메인 화면 (탭 네비게이션)
│   ├── home_screen.dart               # 홈 화면 (질문 답변)
│   ├── history_screen.dart            # 히스토리 화면
│   └── manage_questions_screen.dart   # 질문 관리 화면
└── widgets/
    ├── text_answer_widget.dart        # 텍스트 답변 위젯
    ├── progress_answer_widget.dart    # 진행도 답변 위젯
    └── check_answer_widget.dart       # 체크 답변 위젯
```

#### 3.2.2 데이터 모델

**Question Model**
```dart
enum QuestionType { text, progress, check }

class Question {
  final String id;
  final String text;
  final QuestionType type;
}
```

**Answer Model**
```dart
class Answer {
  final String questionId;
  final String answer;
  final DateTime timestamp;
}
```

#### 3.2.3 서비스 레이어 (Singleton 패턴)

**QuestionService**
- 질문 로드, 저장, 추가, 수정, 삭제, 재정렬
- JSON → SharedPreferences 마이그레이션

**StorageService**
- 답변 저장, 조회, 삭제
- 질문별 최신 답변 조회
- 전체 답변 초기화

**NotificationService**
- 알림 초기화 및 권한 요청
- 백그라운드 알림 스케줄링
- WorkManager 통합

### 3.3 데이터 흐름

#### 3.3.1 질문 로드 흐름
```
앱 시작 → QuestionService.loadQuestions()
  ↓
마이그레이션 여부 확인 (SharedPreferences)
  ↓
[미마이그레이션] → assets/questions.json 로드 → SharedPreferences 저장
  ↓
[마이그레이션됨] → SharedPreferences에서 직접 로드
  ↓
HomeScreen에 질문 목록 표시
```

#### 3.3.2 답변 저장 흐름
```
사용자 답변 입력 → 저장하기 버튼 클릭
  ↓
Answer 객체 생성 (questionId, answer, timestamp)
  ↓
StorageService.saveAnswer()
  ↓
SharedPreferences에 JSON 형태로 저장
  ↓
UI 업데이트 (카드 축소, 색상 변경, 미리보기 표시)
  ↓
스낵바 피드백 표시
```

#### 3.3.3 알림 스케줄링 흐름
```
앱 백그라운드 전환 (WidgetsBindingObserver)
  ↓
didChangeAppLifecycleState(paused/inactive/detached)
  ↓
NotificationService.scheduleNotification()
  ↓
WorkManager.registerOneOffTask (5초 지연)
  ↓
callbackDispatcher 실행
  ↓
flutter_local_notifications.show()
  ↓
사용자에게 알림 표시
```

### 3.4 성능 요구사항
- **앱 시작 시간**: 2초 이내
- **답변 저장 시간**: 500ms 이내
- **화면 전환**: 부드러운 애니메이션 (300ms)
- **알림 정확도**: ±5초 이내

### 3.5 보안 및 프라이버시
- **로컬 저장**: 모든 데이터는 기기 내부에만 저장
- **서버 통신 없음**: 네트워크 권한 불필요
- **단일 사용자**: 다중 사용자 인증 없음
- **데이터 암호화**: 현재 미적용 (향후 고려 가능)

---

## 4. 비기능 요구사항

### 4.1 사용성
- 별도 튜토리얼 없이 직관적으로 사용 가능
- 3번의 탭/클릭 이내로 모든 주요 기능 접근
- 명확한 시각적 피드백 제공

### 4.2 안정성
- 앱 크래시 방지
- 데이터 손실 방지 (저장 실패 시 에러 처리)
- 예외 상황 처리 (null 체크, try-catch)

### 4.3 확장성
- 질문 타입 추가 용이
- 새로운 화면 추가 용이
- 서비스 모듈 독립성 유지

### 4.4 유지보수성
- 명확한 코드 구조
- Singleton 패턴으로 서비스 관리
- 위젯 재사용성 고려

---

## 5. 개발 범위

### 5.1 현재 버전 (v1.0) 포함 기능
✅ 세 가지 타입의 질문 답변 (텍스트, 진행도, 체크)
✅ 질문 관리 (추가, 수정, 삭제, 재정렬)
✅ 답변 히스토리 조회
✅ 백그라운드 알림
✅ 답변 초기화
✅ 이전 답변 로드
✅ 확장/축소 UI
✅ 탭 네비게이션
✅ 탭 이동 시 자동 새로고침

### 5.2 제외 기능 (Out of Scope)
❌ 다중 사용자 지원
❌ 클라우드 동기화
❌ 소셜 기능 (공유, 커뮤니티)
❌ 데이터 분석 및 통계
❌ 리마인더 시간 커스터마이징
❌ 테마 변경 (다크모드)
❌ 데이터 내보내기/가져오기
❌ iOS 지원

### 5.3 향후 고려 사항 (Future Roadmap)
- 📊 답변 통계 및 시각화 (차트, 그래프)
- 📅 캘린더 뷰
- 🔔 커스텀 알림 시간 설정
- 🎨 테마 및 색상 커스터마이징
- 📤 데이터 백업 및 복원
- 🔒 데이터 암호화
- 🍎 iOS 버전
- 🌐 다국어 지원
- 🏆 달성률 및 배지 시스템

---

## 6. 제약사항 및 가정

### 6.1 제약사항
- **플랫폼**: Android만 지원 (iOS 미지원)
- **오프라인 전용**: 네트워크 연결 불필요
- **단일 사용자**: 계정 시스템 없음
- **로컬 저장소**: SharedPreferences 용량 제한 (일반적으로 수 MB)
- **알림**: 백그라운드 제약 (Android 배터리 최적화에 따라 지연 가능)

### 6.2 가정
- 사용자는 Android 기기를 사용함
- 사용자는 알림 권한을 허용함
- 사용자는 하루에 한 번 정도 앱을 사용함
- 질문 개수는 50개 이하 (성능 고려)
- 답변 히스토리는 6개월 이내 데이터만 활발히 조회됨

---

## 7. 성공 지표

### 7.1 정량적 지표
- **DAU(일일 활성 사용자)**: 목표 사용자의 80% 이상이 주 5회 이상 사용
- **답변 완료율**: 하루 평균 6개 이상 질문에 답변
- **앱 크래시율**: 1% 미만
- **평균 세션 시간**: 2-5분

### 7.2 정성적 지표
- 사용자가 직관적으로 모든 기능을 이해하고 사용할 수 있는가?
- 사용자가 일일 체크인 습관을 형성하는 데 도움이 되는가?
- 사용자가 과거 기록을 통해 자신의 변화를 인식할 수 있는가?

---

## 8. 위험 및 대응 방안

### 8.1 기술적 위험

| 위험 | 영향도 | 대응 방안 |
|------|--------|-----------|
| Android 버전별 알림 동작 차이 | 높음 | 최신 Android API 사용, 테스트 강화 |
| SharedPreferences 데이터 손실 | 중간 | 저장 전 백업 로직 추가 고려 |
| 백그라운드 작업 제한 | 중간 | 사용자에게 배터리 최적화 해제 안내 |
| 메모리 부족 (대량 데이터) | 낮음 | 페이지네이션 또는 데이터 아카이빙 |

### 8.2 사용자 경험 위험

| 위험 | 영향도 | 대응 방안 |
|------|--------|-----------|
| 알림 무시 | 중간 | 알림 문구 개선, 타이밍 최적화 |
| 질문이 지루함 | 중간 | 질문 관리 기능으로 커스터마이징 지원 |
| 데이터 손실 우려 | 낮음 | 명확한 안내 문구, 향후 백업 기능 추가 |

---

## 9. 릴리스 계획

### 9.1 Phase 1 - MVP (완료)
**목표**: 핵심 기능 구현 및 POC 검증

- ✅ 질문 답변 기능 (3가지 타입)
- ✅ 질문 로드 (JSON → SharedPreferences)
- ✅ 답변 히스토리
- ✅ 백그라운드 알림
- ✅ 기본 UI/UX

### 9.2 Phase 2 - 개선 (완료)
**목표**: 사용성 개선 및 버그 수정

- ✅ 확장/축소 UI
- ✅ 이전 답변 로드
- ✅ 답변 초기화
- ✅ 체크 타입 추가
- ✅ 질문 관리 화면
- ✅ 탭 새로고침

### 9.3 Phase 3 - 향후 계획 (미정)
**목표**: 사용자 피드백 기반 기능 추가

- 답변 통계 및 시각화
- 커스텀 알림 시간
- 데이터 백업/복원
- 테마 커스터마이징

---

## 10. 부록

### 10.1 용어 정의
- **질문 (Question)**: 사용자에게 제시되는 일일 체크인 항목
- **답변 (Answer)**: 사용자가 질문에 대해 입력한 응답
- **타입 (Type)**: 질문의 답변 형식 (text, progress, check)
- **히스토리 (History)**: 과거에 작성한 답변 기록
- **카드 (Card)**: 질문을 표시하는 UI 컴포넌트

### 10.2 참고 자료
- Flutter 공식 문서: https://flutter.dev/docs
- Material Design 3: https://m3.material.io/
- flutter_local_notifications: https://pub.dev/packages/flutter_local_notifications
- workmanager: https://pub.dev/packages/workmanager

### 10.3 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 1.0 | 2025-10-25 | 초안 작성 | Claude Code |

---

**문서 승인**

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| Product Owner | - | - | - |
| Tech Lead | - | - | - |
| Developer | - | - | - |

---

## 11. 추가 정보

### 11.1 질문 카테고리 및 예시

현재 앱에 포함된 8개 질문은 다음과 같이 분류됩니다:

**🎯 생산성 (Productivity)**
- "오늘 어떤 일들을 했나요?" (텍스트)
- "핵심 목표는 얼마나 달성했나요?" (진행도)

**🌱 환경 (Environment)**
- "오늘 일과 중 지속가능한 선택을 한 것이 있나요?" (텍스트)
- "오늘 어떻게 제로웨이스트를 실천했나요?" (텍스트)

**💪 건강 (Health)**
- "오늘 어떤 운동을 했나요?" (텍스트)
- "비타민을 챙겨 먹었나요?" (체크)
- "오늘 기분은 어떤가요?" (진행도)
- "오늘 가장 감사한 일은 무엇인가요?" (텍스트)

### 11.2 빌드 설정

**Android 최소 요구사항**
- minSdkVersion: 21 (Android 5.0 Lollipop)
- targetSdkVersion: 34 (Android 14)
- compileSdkVersion: 34

**필수 권한**
```xml
<uses-permission android:name="android.permission.POST_NOTIFICATIONS"/>
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
<uses-permission android:name="android.permission.WAKE_LOCK"/>
<uses-permission android:name="android.permission.SCHEDULE_EXACT_ALARM"/>
```

### 11.3 알려진 이슈 및 제한사항
- Android 12+ 기기에서 배터리 최적화가 활성화된 경우 백그라운드 알림이 지연될 수 있음
- 매우 긴 텍스트 답변(1000자 이상)의 경우 히스토리 화면에서 성능 저하 가능
- 질문이 100개 이상으로 늘어날 경우 앱 시작 시간이 증가할 수 있음

---

**End of Document**
